<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-list/core-list.html">
<link rel="import" href="../../bower_components/core-signals/core-signals.html">

<polymer-element name="gang-messages" attributes="" >
    <template>
        <link rel="stylesheet" href="gang-messages.css">

        <core-signals on-core-signal-new-message='{{appendMessage}}'></core-signals>

            <template repeat="{{message in messages}}">
                <p class="msg-bubble"> {{message.text}}</p>
            </template>

    </template>

    <script src='../../bower_components/socket.io-client/socket.io.js'></script>

    <script>
    (function() {

        Polymer({

            messages: [],

            ready: function() {

                var self = this;

                var socket = this.socket = io.connect('http://gang-backend-demo.herokuapp.com:80');

                socket.on('message', function(data) {

                    self.messages.push(data);
                });
            },

            appendMessage: function(e, detail, sender) {
                this.messages.push(detail);
                this.socket.emit('new-message', detail);
            }

        });


    })();
    </script>
</polymer-element>
